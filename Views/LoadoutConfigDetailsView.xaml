<UserControl x:Class="ARA.Views.LoadoutConfigDetailsView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" 
			 xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
			 mc:Ignorable="d"
			 xmlns:pages="clr-namespace:ARA.ViewModels.Pages" 
			 xmlns:controls="clr-namespace:ARA.Controls.CustomControls"
			 xmlns:enums="clr-namespace:ARA.Enums"
			 xmlns:d="http://schemas.microsoft.com/expression/blend/2008" d:DataContext="{d:DesignInstance Type=pages:LoadoutConfigDetailsViewModel}">
	<Grid>
		<Grid.RowDefinitions>
			<RowDefinition Height="40" />
			<RowDefinition Height="12" />
			<RowDefinition Height="*" />
			<RowDefinition Height="12" />
			<RowDefinition Height="40" />
		</Grid.RowDefinitions>

		<Grid Grid.Row="0">
			<Grid.ColumnDefinitions>
				<ColumnDefinition Width="Auto" />
				<ColumnDefinition Width="12" />
				<ColumnDefinition Width="Auto" />
			</Grid.ColumnDefinitions>

			<controls:AraButton Grid.Column="0" Style="{StaticResource PageTitleButton}" Command="{Binding BackCommand}">
				<controls:AraButton.Children>
					<Image Style="{StaticResource ButtonImage}" Source="/Assets/Icons/chevron-left.png" />
				</controls:AraButton.Children>
			</controls:AraButton>
			<TextBlock Grid.Column="2" Style="{StaticResource PageTitle}" Text="{Binding Title}" />
		</Grid>

		<ScrollViewer Focusable="False" Grid.Row="2" VerticalScrollBarVisibility="Auto">
			<Grid>
				<Grid.RowDefinitions>
					<RowDefinition Height="Auto" />
					<RowDefinition Height="16" />
					<RowDefinition Height="Auto" />
					<RowDefinition Height="16" />
					<RowDefinition Height="Auto" />
				</Grid.RowDefinitions>

				<!-- Name -->
				<StackPanel Grid.Row="0">
					<Label Style="{StaticResource AraLabel}" Target="{Binding ElementName=NameTextBox}">Name</Label>
					<controls:AraTextBox x:Name="NameTextBox" 
						Text="{Binding Name, UpdateSourceTrigger=PropertyChanged}" 
						PlaceholderText="Name" 
						Style="{StaticResource AraTextBox}"
						IsError="{Binding LoadoutValidation.IsNameNotValid}"
						MaxLength="50"/>
				</StackPanel>

				<!-- Zone -->
				<GroupBox Grid.Row="2" Header="Zone" Style="{StaticResource AraGroupBox}">
					<Grid>
						<Grid.RowDefinitions>
							<RowDefinition Height="40"/>
							<RowDefinition Height="16"/>
							<RowDefinition Height="Auto"/>
						</Grid.RowDefinitions>

						<controls:AraButton Grid.Row="0" Style="{StaticResource SecondaryButton}" Command="{Binding SelectRegionCommand}">
							<controls:AraButton.Children>
								<Image Style="{StaticResource ButtonImage}" Source="/Assets/Icons/zone.png" />
								<TextBlock Text="Select Zone" Margin="4 0 0 0"/>
							</controls:AraButton.Children>
						</controls:AraButton>
						<Grid Grid.Row="2">
							<Grid.ColumnDefinitions>
								<ColumnDefinition Width="*" />
								<ColumnDefinition Width="8" />
								<ColumnDefinition Width="*" />
								<ColumnDefinition Width="8" />
								<ColumnDefinition Width="*" />
								<ColumnDefinition Width="8" />
								<ColumnDefinition Width="*" />
							</Grid.ColumnDefinitions>

							<StackPanel Grid.Column="0">
								<Label Style="{StaticResource AraLabel}" Target="{Binding ElementName=X}">X</Label>
								<controls:AraTextBox 
									x:Name="X" 
									Text="{Binding CoordinatesX, UpdateSourceTrigger=PropertyChanged, TargetNullValue=''}" 
									PlaceholderText="X" Style="{StaticResource AraTextBox}" 
									InputType="{x:Static enums:TextBoxInputType.Number}" 
									IsError="{Binding LoadoutValidation.IsCoordinateXNotValid}"
									MaxLength="10"/>
							</StackPanel>
							<StackPanel Grid.Column="2">
								<Label Style="{StaticResource AraLabel}" Target="{Binding ElementName=Y}">Y</Label>
								<controls:AraTextBox 
									x:Name="Y" 
									Text="{Binding CoordinatesY, UpdateSourceTrigger=PropertyChanged, TargetNullValue=''}" 
									PlaceholderText="Y" Style="{StaticResource AraTextBox}" 
									InputType="{x:Static enums:TextBoxInputType.Number}"
									IsError="{Binding LoadoutValidation.IsCoordinateYNotValid}"
									MaxLength="10"/>
							</StackPanel>
							<StackPanel Grid.Column="4">
								<Label Style="{StaticResource AraLabel}" Target="{Binding ElementName=ZoneWidth}">Width</Label>
								<controls:AraTextBox 
									x:Name="ZoneWidth" 
									Text="{Binding CoordinatesWidth, UpdateSourceTrigger=PropertyChanged, TargetNullValue=''}" 
									PlaceholderText="Zone Width" Style="{StaticResource AraTextBox}" 
									InputType="{x:Static enums:TextBoxInputType.Number}" 
									IsError="{Binding LoadoutValidation.IsCoordinateWidthNotValid}"
									MaxLength="10"/>
							</StackPanel>
							<StackPanel Grid.Column="6">
								<Label Style="{StaticResource AraLabel}" Target="{Binding ElementName=ZoneHeight}">Height</Label>
								<controls:AraTextBox 
									x:Name="ZoneHeight" 
									Text="{Binding CoordinatesHeight, UpdateSourceTrigger=PropertyChanged, TargetNullValue=''}" 
									PlaceholderText="Zone Height" Style="{StaticResource AraTextBox}" 
									InputType="{x:Static enums:TextBoxInputType.Number}" 
									IsError="{Binding LoadoutValidation.IsCoordinateHeightNotValid}"
									MaxLength="10"/>
							</StackPanel>
						</Grid>
					</Grid>
				</GroupBox>

				<!-- Items -->
				<GroupBox Grid.Row="4" Header="Items" Style="{StaticResource AraGroupBox}">
					<Grid>
						<Grid.RowDefinitions>
							<RowDefinition Height="Auto" />
							<RowDefinition Height="12" />
							<RowDefinition Height="*" />
						</Grid.RowDefinitions>

						<Grid Grid.Row="0">
							<Grid.ColumnDefinitions>
								<ColumnDefinition Width="*"/>
								<ColumnDefinition Width="12"/>
								<ColumnDefinition Width="Auto"/>
							</Grid.ColumnDefinitions>

							<controls:AraComboBox
								x:Name="ItemsComboBox"
								IsEditable="True"
								StaysOpenOnEdit="True"
								IsTextSearchEnabled="False"
								Style="{StaticResource AraComboBox}"
								PlaceholderText="Select Item"
								TextSearch.TextPath="Name"
								ItemsSource="{Binding ItemsList}"
								SelectedItem="{Binding SelectedItem, Mode=TwoWay}">
								<controls:AraComboBox.ItemTemplate>
									<DataTemplate>
										<StackPanel Orientation="Horizontal">
											<Image Source="{Binding Path}" Height="32" Stretch="Uniform" VerticalAlignment="Center"/>
											<TextBlock Text="{Binding Name}" VerticalAlignment="Center" Margin="8 0 0 0"/>
										</StackPanel>
									</DataTemplate>
								</controls:AraComboBox.ItemTemplate>
							</controls:AraComboBox>

							<controls:AraButton Grid.Column="2" Command="{Binding AddItemCommand}">
								<controls:AraButton.Children>
									<Image Style="{StaticResource ButtonImage}" Source="/Assets/Icons/plus.png" />
									<TextBlock Text="Add" Margin="4 0 0 0"/>
								</controls:AraButton.Children>
								<controls:AraButton.Style>
									<Style TargetType="controls:AraButton" BasedOn="{StaticResource SecondaryButton}">
										<Style.Triggers>
											<DataTrigger Binding="{Binding SelectedItem}" Value="{x:Null}">
												<Setter Property="IsEnabled" Value="False" />
											</DataTrigger>
										</Style.Triggers>
									</Style>
								</controls:AraButton.Style>
							</controls:AraButton>
						</Grid>

						<Grid Grid.Row="2">
							<!-- Loadout Items Grid -->
							<Border>
								<Border.Style>
									<Style TargetType="Border" BasedOn="{StaticResource DataGridBorderWrapper}">
										<Style.Triggers>
											<DataTrigger Binding="{Binding SelectedItemsList.Count}" Value="0">
												<Setter Property="Visibility" Value="Hidden"/>
											</DataTrigger>
										</Style.Triggers>
									</Style>
								</Border.Style>
								<DataGrid x:Name="LoadoutPreview" ItemsSource="{Binding SelectedItemsList}">
									<DataGrid.Columns>
										<!-- Icon -->
										<DataGridTemplateColumn Header="Icon" Width="60">
											<DataGridTemplateColumn.CellTemplate>
												<DataTemplate>
													<Image Source="{Binding Path}" Height="48" Stretch="Uniform" VerticalAlignment="Center"/>
												</DataTemplate>
											</DataGridTemplateColumn.CellTemplate>
										</DataGridTemplateColumn>
										<!-- Name -->
										<DataGridTemplateColumn Header="Name" Width="*">
											<DataGridTemplateColumn.CellTemplate>
												<DataTemplate>
													<TextBlock Text="{Binding Name}"/>
												</DataTemplate>
											</DataGridTemplateColumn.CellTemplate>
										</DataGridTemplateColumn>
										<!-- Quantity -->
										<DataGridTemplateColumn Header="Quantity" Width="Auto">
											<DataGridTemplateColumn.CellTemplate>
												<DataTemplate>
													<TextBlock Text="{Binding Quantity}"/>
												</DataTemplate>
											</DataGridTemplateColumn.CellTemplate>
										</DataGridTemplateColumn>
										<!-- Actions -->
										<DataGridTemplateColumn Header="Actions" Width="Auto">
											<DataGridTemplateColumn.CellTemplate>
												<DataTemplate>
													<controls:AraButton 
														Style="{StaticResource PageTitleButton}" 
														Command="{Binding DataContext.RemoveItemCommand, RelativeSource={RelativeSource AncestorType=DataGrid}}"
														CommandParameter="{Binding}">
														<controls:AraButton.Children>
															<Image Style="{StaticResource ButtonImage}" Source="/Assets/Icons/DataGrid/Delete.png" />
														</controls:AraButton.Children>
													</controls:AraButton>
												</DataTemplate>
											</DataGridTemplateColumn.CellTemplate>
										</DataGridTemplateColumn>
									</DataGrid.Columns>
								</DataGrid>
							</Border>
							<!-- No Configurations Message -->
							<StackPanel Orientation="Vertical" >
								<StackPanel.Style>
									<Style TargetType="StackPanel">
										<Setter Property="Visibility" Value="Collapsed"/>
										<Style.Triggers>
											<DataTrigger Binding="{Binding SelectedItemsList.Count}" Value="0">
												<Setter Property="Visibility" Value="Visible" />
											</DataTrigger>
										</Style.Triggers>
									</Style>
								</StackPanel.Style>
								<TextBlock Text="You don't have any Loadout Items yet.">
									<TextBlock.Style>
										<Style TargetType="TextBlock" BasedOn="{StaticResource DataGridNoItemsMessage}">
											<Style.Triggers>
												<DataTrigger Binding="{Binding LoadoutValidation.IsItemsListNotValid}" Value="True">
													<Setter Property="Foreground" Value="{StaticResource TextColorError}"/>
												</DataTrigger>
											</Style.Triggers>
										</Style>
									</TextBlock.Style>
								</TextBlock>
								<TextBlock Text="Use the combobox and button [ Add ] to add your first item.">
									<TextBlock.Style>
										<Style TargetType="TextBlock" BasedOn="{StaticResource DataGridNoItemsMessage}">
											<Style.Triggers>
												<DataTrigger Binding="{Binding LoadoutValidation.IsItemsListNotValid}" Value="True">
													<Setter Property="Foreground" Value="{StaticResource TextColorError}"/>
												</DataTrigger>
											</Style.Triggers>
										</Style>
									</TextBlock.Style>
								</TextBlock>
							</StackPanel>
						</Grid>
					</Grid>
				</GroupBox>
			</Grid>
		</ScrollViewer>

		<Grid Grid.Row="4">
			<Grid.ColumnDefinitions>
				<ColumnDefinition Width="*"/>
				<ColumnDefinition Width="Auto"/>
			</Grid.ColumnDefinitions>

			<!-- Validation Message -->
			<StackPanel Grid.Column="0" Orientation="Vertical" >
				<StackPanel.Style>
					<Style TargetType="StackPanel">
						<Setter Property="Visibility" Value="Collapsed"/>
						<Style.Triggers>
							<DataTrigger Binding="{Binding IsValid}" Value="False">
								<Setter Property="Visibility" Value="Visible" />
							</DataTrigger>
						</Style.Triggers>
					</Style>
				</StackPanel.Style>
				<TextBlock Style="{StaticResource ValidationErrorMessage}" Text="One or more validation errors."/>
				<TextBlock Style="{StaticResource ValidationErrorMessage}" Text="Fill all required fields and/or add at least one item."/>
			</StackPanel>

			<controls:AraButton Grid.Column="1" Command="{Binding SaveLoadoutConfigurationCommand}">
				<controls:AraButton.Style>
					<Style TargetType="controls:AraButton" BasedOn="{StaticResource PrimaryButton}">
						<Style.Triggers>
							<DataTrigger Binding="{Binding IsEdited}" Value="False">
								<Setter Property="IsEnabled" Value="False" />
							</DataTrigger>
						</Style.Triggers>
					</Style>
				</controls:AraButton.Style>
				<controls:AraButton.Children>
					<TextBlock Text="Save" />
				</controls:AraButton.Children>
			</controls:AraButton>
		</Grid>
	</Grid>
</UserControl>
